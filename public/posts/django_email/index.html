<!doctype html>
<html lang="en-us">
  <head>
    <title>Add Email to a Django App // AgilePhD</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.128.2">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Dr. James Davis" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/css/main.min.562871a81790ee61fbc41ddb89eacf3bc0967ee9bde46cf8764c66fe91f0e6fc.css" />
    

    
  


    
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Add Email to a Django App">
  <meta name="twitter:description" content="Email Adding email to an application allows us to provide a better user experience. Users have come to expect certain features such as account confirmation and password reset which are usually accomplished via email.
A version of this code can be viewed on GitHub.
SendGrid You could acquire email services through dozens of reputable providers but one of the easiest, and free-ist, methods is to use the Sendgrid add-on via Heroku.">

    <meta property="og:url" content="https://blog.agilephd.com/posts/django_email/">
  <meta property="og:site_name" content="AgilePhD">
  <meta property="og:title" content="Add Email to a Django App">
  <meta property="og:description" content="Email Adding email to an application allows us to provide a better user experience. Users have come to expect certain features such as account confirmation and password reset which are usually accomplished via email.
A version of this code can be viewed on GitHub.
SendGrid You could acquire email services through dozens of reputable providers but one of the easiest, and free-ist, methods is to use the Sendgrid add-on via Heroku.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2020-01-15T00:00:00+00:00">
    <meta property="article:modified_time" content="2020-01-15T00:00:00+00:00">
    <meta property="article:tag" content="Django">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Heroku">


  </head>
  <body>
    <header class="app-header">
      <a href="https://blog.agilephd.com/"><img class="app-header-avatar" src="/tank1.jpg" alt="Dr. James Davis" /></a>
      <span class="app-header-title">AgilePhD</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/tags/">Tags</a>
             - 
          
          <a class="app-header-menu-item" href="/about/">About</a>
      </nav>
      <p>Dr. James Davis: data scientist, girl dad, combat veteran, and can&#39;t shutup about Blockchain.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/cavalryjim" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.linkedin.com/in/jdavisphd/" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>LinkedIn</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Add Email to a Django App</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jan 15, 2020
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://blog.agilephd.com/tags/django/">Django</a>
              <a class="tag" href="https://blog.agilephd.com/tags/python/">Python</a>
              <a class="tag" href="https://blog.agilephd.com/tags/heroku/">Heroku</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h1 id="email">Email</h1>
<p><img src="../../email.png" alt="email"></p>
<p>Adding email to an application allows us to provide a better user experience.  Users have come to expect certain features such as account confirmation and password reset which are usually accomplished via email.</p>
<p>A version of this code can be viewed on <a href="https://github.com/cavalryjim/tweeter_v5">GitHub</a>.</p>
<h3 id="sendgrid">SendGrid</h3>
<p>You could acquire email services through dozens of reputable providers but one of the easiest, and free-ist, methods is to use the Sendgrid add-on via Heroku.</p>
<pre tabindex="0"><code>(tweeter_app) $ heroku addons:create sendgrid:starter
Creating sendgrid:starter on â¬¢ secret-river-48719... free
...
(tweeter_app) $ heroku config:get SENDGRID_USERNAME
app161585718@heroku.com
(tweeter_app) $ heroku config:get SENDGRID_PASSWORD
90e3xxxxxxxx
</code></pre><p>Make a note of the <code>SENDGRID_USERNAME</code> and <code>SENDGRID_PASSWORD</code> as we will need those when setting up the email server connection.</p>
<p>Edit the <code>tweeter_app/settings.py</code> file to define our email service.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># settings.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LOGIN_REDIRECT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;home&#39;</span>
</span></span><span style="display:flex;"><span>LOGOUT_REDIRECT_URL <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;home&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>EMAIL_BACKEND <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;django.core.mail.backends.smtp.EmailBackend&#39;</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;smtp.gmail.com&#39;</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST_USER <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#39;xxxxx@gmail&#39;</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST_PASSWORD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xxxxxxxxxx&#39;</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">587</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_USE_TLS <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span> <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>Note that you will use your email provider <code>EMAIL_HOST_USER</code> and <code>EMAIL_HOST_PASSWORD</code>.  Also note that it is a really, really bad practice to openly display password or API keys directly in source code.  There are people that scan public repositories for this information and use it for Spamming or other bad things.  Later in this chapter, I will cover how store your secrets in environmental variables.</p>
<p>Start the development server.</p>
<pre tabindex="0"><code>(tweeter_app) $ python manage.py runserver
</code></pre><p>Let&rsquo;s see if our email connection is working by logging out (if you are logged in) and trying the password reset feature.</p>
<p><img src="../../reset_password_screen.png" alt="password reset page"></p>
<p>If everything is working, you should have received an email from
webmaster@localhost.</p>
<h2 id="environmental-variables">Environmental Variables</h2>
<p>There are several methods for handling environmental variables.  Here is the method most commonly endorsed by the Django community.</p>
<pre tabindex="0"><code>$ pip install django-environ
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e"># settings.py</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> django_heroku
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> environ <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>env <span style="color:#f92672">=</span> environ<span style="color:#f92672">.</span>Env() <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># reading .env file</span>
</span></span><span style="display:flex;"><span>environ<span style="color:#f92672">.</span>Env<span style="color:#f92672">.</span>read_env() <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>EMAIL_BACKEND <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;django.core.mail.backends.smtp.EmailBackend&#39;</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;smtp.gmail.com&#39;</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST_USER <span style="color:#f92672">=</span>  env<span style="color:#f92672">.</span>str(<span style="color:#e6db74">&#39;GMAIL_USERNAME&#39;</span>) <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_HOST_PASSWORD <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>str(<span style="color:#e6db74">&#39;GMAIL_PASSWORD&#39;</span>) <span style="color:#75715e"># new</span>
</span></span><span style="display:flex;"><span>EMAIL_PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">587</span>
</span></span><span style="display:flex;"><span>EMAIL_USE_TLS <span style="color:#f92672">=</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">...</span>
</span></span></code></pre></div><p>For our local environmental variable, create a <em>.env</em> file inside the base folder of your tweeter project.  Inside of the <code>.env</code> file, add your sendgrid credentials.</p>
<pre tabindex="0"><code>GMAIL_USERNAME=&#39;xxxxxxxx@gmail.com&#39;
GMAIL_PASSWORD=&#39;yupxxxxxxxxxxxx&#39;
</code></pre><h3 id="git-ignore">Git Ignore</h3>
<p>Now that we have created a <code>.env</code> file, it would be a good opportunity to define a <code>.gitignore</code> file.  This file specifies any files that will not be tracked as part of our Git repository.  Thus, this list of files will be ignored.</p>
<pre tabindex="0"><code>staticfiles
.env
db.sqlite3
</code></pre>
    </div>
    
    <div class="post-footer">
      
    </div>
  </article>

  <h4>Comments:</h4>
  <div id="cusdis_thread" data-host="https://cusdis.com"
    data-app-id="00693eb6-18f3-4176-b3ba-cf9245891bce"
    data-page-id="074d4e5fa5dad86f6edfb7e0997da94c" 
    data-page-url="https://blog.agilephd.com/posts/django_email/"
    data-page-title="Add Email to a Django App"
    data-theme="auto">
  </div>
  <script async defer src="https://cusdis.com/js/cusdis.es.js"></script>
  
  

    </main>
  </body>
</html>
